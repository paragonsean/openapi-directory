openapi: 3.0.0
info:
  contact:
    email: getsupport@patrowl.io
    x-twitter: patrowl_io
  description: This is the API documentation for Patrowl Engines usage.
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  title: Swagger API-REST for Patrowl Engines
  version: 1.0.0
  x-apisguru-categories:
  - security
  x-logo:
    url: https://twitter.com/patrowl_io/profile_image?size=original
  x-origin:
  - converter:
      url: https://github.com/mermade/oas-kit
      version: 7.0.4
    format: openapi
    url: https://raw.githubusercontent.com/Patrowl/PatrowlDocs/master/api/openapi-patrowl-engines.yaml
    version: "3.0"
  x-providerName: patrowl.local
externalDocs:
  description: Find out more about Patrowl
  url: https://github.com/Patrowl/PatrowlDocs
servers:
- url: http://patrowl.local
- url: http://localhost:5001/engines/nmap/
- url: http://localhost:5004/engines/ssllabs/
- url: http://localhost:5005/engines/arachni/
- url: http://localhost:5006/engines/owl_dns/
- url: http://localhost:5007/engines/virustotal/
- url: http://localhost:5008/engines/urlvoid/
- url: http://localhost:5009/engines/cortex/
- url: http://localhost:5012/engines/owl_leaks/
- url: http://localhost:5013/engines/owl_code/
- url: http://localhost:5014/engines/sslscan/
tags:
- description: SSLScan API documentation
  externalDocs:
    description: Find out more
    url: https://github.com/Patrowl/PatrowlDocs
  name: patrowl-engine
paths:
  /:
    get:
      description: Return index page
      operationId: get_default_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Index page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /clean:
    get:
      description: Clean all current scans.
      operationId: clean_scans_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Clean all scans
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /clean/{scanId}:
    get:
      description: Clean scan identified by id.
      operationId: clean_scan_page
      parameters:
      - description: Numeric ID of the scan to clean
        explode: false
        in: path
        name: scanId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Clean scan
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /getfindings/{scanId}:
    get:
      description: Get findings on finished scans.
      operationId: get_finding_page
      parameters:
      - description: Numeric ID of the scan to get findings
        explode: false
        in: path
        name: scanId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Findings'
          description: successful operation
      summary: Get findings on finished scans
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /info:
    get:
      description: Return information on engine.
      operationId: get_info_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Engine info page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /liveness:
    get:
      description: Return liveness page
      operationId: get_liveness_page
      responses:
        "200":
          description: successful operation
      summary: Liveness page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /readiness:
    get:
      description: Return liveness page
      operationId: get_readiness_page
      responses:
        "200":
          description: successful operation
      summary: Readiness page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /reloadconfig:
    get:
      description: Reload the configuration file.
      operationId: reload_configuration_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Configuration reloading page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /startscan:
    post:
      description: Start a new scan.
      operationId: start_scan_page
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScanDefinition'
        required: true
        x-body-name: body
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Start a new scan
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
      x-codegen-request-body-name: body
  /status:
    get:
      description: Status all current scans.
      operationId: status_scans_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Status on all scans
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /status/{scanId}:
    get:
      description: Status of a scan identified by id.
      operationId: status_scan_page
      parameters:
      - description: Numeric ID of the scan to get status
        explode: false
        in: path
        name: scanId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Status of a scan
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /stop/{scanId}:
    get:
      description: Stop a scan identified by id.
      operationId: stop_scan_page
      parameters:
      - description: Numeric ID of the scan to stop
        explode: false
        in: path
        name: scanId
        required: true
        schema:
          type: integer
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Stop a scan
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /stopscans:
    get:
      description: Stop all current scans.
      operationId: stop_scans_page
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
          description: successful operation
      summary: Stop all scans
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
  /test:
    get:
      description: Return test page
      operationId: get_test_page
      responses:
        "200":
          description: successful operation
      summary: Test page
      tags:
      - patrowl-engine
      x-openapi-router-controller: openapi_server.controllers.patrowl_engine_controller
components:
  schemas:
    ApiResponse:
      example:
        page: page
        status: status
      properties:
        page:
          title: page
          type: string
        status:
          title: status
          type: string
      title: ApiResponse
    Findings:
      items:
        $ref: '#/components/schemas/Findings_inner'
      type: array
    ScanDefinition:
      example:
        assets:
        - datatype: ip
          criticity: low
          id: "3"
          value: 8.8.8.8
        - datatype: ip
          criticity: low
          id: "3"
          value: 8.8.8.8
        options: "{}"
        scan_id: 1
      properties:
        assets:
          items:
            $ref: '#/components/schemas/ScanDefinition_assets_inner'
          title: assets
          type: array
        options:
          title: options
          type: object
        scan_id:
          example: 1
          title: scan_id
          type: integer
      title: ScanDefinition
    Findings_inner_meta_risk:
      example:
        exploit_available:
        - exploit_available
        - exploit_available
        exploitability_ease:
        - exploitability_ease
        - exploitability_ease
        cvss_base_score:
        - cvss_base_score
        - cvss_base_score
        cvss_vector:
        - cvss_vector
        - cvss_vector
        patch_publication_date:
        - patch_publication_date
        - patch_publication_date
      properties:
        cvss_base_score:
          items:
            type: string
          title: cvss_base_score
          type: array
        cvss_vector:
          items:
            type: string
          title: cvss_vector
          type: array
        exploit_available:
          items:
            type: string
          title: exploit_available
          type: array
        exploitability_ease:
          items:
            type: string
          title: exploitability_ease
          type: array
        patch_publication_date:
          items:
            type: string
          title: patch_publication_date
          type: array
      title: Findings_inner_meta_risk
      type: object
    Findings_inner_meta_vuln_refs:
      example:
        cwe:
        - cwe
        - cwe
        cve:
        - cve
        - cve
        cpe:
        - cpe
        - cpe
        bid:
        - bid
        - bid
      properties:
        bid:
          items:
            type: string
          title: bid
          type: array
        cpe:
          items:
            type: string
          title: cpe
          type: array
        cve:
          items:
            type: string
          title: cve
          type: array
        cwe:
          items:
            type: string
          title: cwe
          type: array
      title: Findings_inner_meta_vuln_refs
      type: object
    Findings_inner:
      example:
        severity: info
        issue_id: 0
        meta_vuln_refs:
          cwe:
          - cwe
          - cwe
          cve:
          - cve
          - cve
          cpe:
          - cpe
          - cpe
          bid:
          - bid
          - bid
        confidence: confidence
        description: description
        raw: raw
        meta_risk:
          exploit_available:
          - exploit_available
          - exploit_available
          exploitability_ease:
          - exploitability_ease
          - exploitability_ease
          cvss_base_score:
          - cvss_base_score
          - cvss_base_score
          cvss_vector:
          - cvss_vector
          - cvss_vector
          patch_publication_date:
          - patch_publication_date
          - patch_publication_date
        title: title
        type: type
        meta_tags:
        - meta_tags
        - meta_tags
        target_proto:
        - target_proto
        - target_proto
        solution: solution
        meta_links:
        - meta_links
        - meta_links
        target_addrs:
        - target_addrs
        - target_addrs
        timestamp: 2000-01-23T04:56:07.000+00:00
      properties:
        confidence:
          title: confidence
          type: string
        description:
          title: description
          type: string
        issue_id:
          title: issue_id
          type: integer
        meta_links:
          items:
            type: string
          title: meta_links
          type: array
        meta_risk:
          $ref: '#/components/schemas/Findings_inner_meta_risk'
        meta_tags:
          items:
            type: string
          title: meta_tags
          type: array
        meta_vuln_refs:
          $ref: '#/components/schemas/Findings_inner_meta_vuln_refs'
        raw:
          title: raw
          type: string
        severity:
          enum:
          - info
          - low
          - medium
          - high
          title: severity
          type: string
        solution:
          title: solution
          type: string
        target_addrs:
          items:
            type: string
          title: target_addrs
          type: array
        target_proto:
          items:
            type: string
          title: target_proto
          type: array
        timestamp:
          format: date-time
          title: timestamp
          type: string
        title:
          title: title
          type: string
        type:
          title: type
          type: string
      title: Findings_inner
      type: object
    ScanDefinition_assets_inner:
      example:
        datatype: ip
        criticity: low
        id: "3"
        value: 8.8.8.8
      properties:
        criticity:
          enum:
          - low
          - medium
          - high
          title: criticity
          type: string
        datatype:
          enum:
          - ip
          - ip-range
          - ip-subnet
          - fqdn
          - domain
          - url
          - keyword
          - person
          - organisation
          - path
          - application
          title: datatype
          type: string
        id:
          example: "3"
          title: id
          type: string
        value:
          example: 8.8.8.8
          title: value
          type: string
      title: ScanDefinition_assets_inner
      type: object
