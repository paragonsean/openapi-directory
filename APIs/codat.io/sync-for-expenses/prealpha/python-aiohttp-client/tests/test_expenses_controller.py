# coding: utf-8

import pytest
import json
from aiohttp import web
from aiohttp import FormData

from openapi_server.models.attachment import Attachment
from openapi_server.models.create_expense_request import CreateExpenseRequest
from openapi_server.models.create_expense_response import CreateExpenseResponse


pytestmark = pytest.mark.asyncio

async def test_create_expense_dataset(client):
    """Test case for create_expense_dataset

    Create expense-transactions
    """
    body = {"items":[{"notes":"APPLE.COM/BILL - 09001077498 - Card Ending: 4590","currency":"GBP","currencyRate":0.8008281904610115,"id":"4d7c6929-7770-412b-91bb-44d3bc71d111","issueDate":"2022-10-23T00:00:00Z","lines":[{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43}],"type":"Payment","merchantName":"Amazon UK"},{"notes":"APPLE.COM/BILL - 09001077498 - Card Ending: 4590","currency":"GBP","currencyRate":0.8008281904610115,"id":"4d7c6929-7770-412b-91bb-44d3bc71d111","issueDate":"2022-10-23T00:00:00Z","lines":[{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43}],"type":"Payment","merchantName":"Amazon UK"},{"notes":"APPLE.COM/BILL - 09001077498 - Card Ending: 4590","currency":"GBP","currencyRate":0.8008281904610115,"id":"4d7c6929-7770-412b-91bb-44d3bc71d111","issueDate":"2022-10-23T00:00:00Z","lines":[{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43}],"type":"Payment","merchantName":"Amazon UK"},{"notes":"APPLE.COM/BILL - 09001077498 - Card Ending: 4590","currency":"GBP","currencyRate":0.8008281904610115,"id":"4d7c6929-7770-412b-91bb-44d3bc71d111","issueDate":"2022-10-23T00:00:00Z","lines":[{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43}],"type":"Payment","merchantName":"Amazon UK"},{"notes":"APPLE.COM/BILL - 09001077498 - Card Ending: 4590","currency":"GBP","currencyRate":0.8008281904610115,"id":"4d7c6929-7770-412b-91bb-44d3bc71d111","issueDate":"2022-10-23T00:00:00Z","lines":[{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43},{"taxRateRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"trackingRefs":[{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"}],"netAmount":110.42,"accountRef":{"id":"40e3e57c-2322-4898-966c-ca41adfd23fd"},"taxAmount":14.43}],"type":"Payment","merchantName":"Amazon UK"}]}
    headers = { 
        'Accept': 'application/json',
        'Content-Type': 'application/json',
        'auth_header': 'special-key',
    }
    response = await client.request(
        method='POST',
        path='/companies/{company_id}/sync/expenses/data/expense-transactions'.format(company_id='8a210b68-6988-11ed-a1eb-0242ac120002'),
        headers=headers,
        json=body,
        )
    assert response.status == 200, 'Response body is : ' + (await response.read()).decode('utf-8')


pytestmark = pytest.mark.asyncio

@pytest.mark.skip("multipart/form-data not supported by Connexion")
async def test_upload_attachment(client):
    """Test case for upload_attachment

    Upload attachment
    """
    headers = { 
        'Accept': 'application/json',
        'Content-Type': 'multipart/form-data',
        'auth_header': 'special-key',
    }
    response = await client.request(
        method='POST',
        path='/companies/{company_id}/sync/expenses/syncs/{sync_id}/transactions/{transaction_id}/attachments'.format(company_id='8a210b68-6988-11ed-a1eb-0242ac120002', transaction_id='336694d8-2dca-4cb5-a28d-3ccb83e55eee', sync_id='6fb40d5e-b13e-11ed-afa1-0242ac120002'),
        headers=headers,
        )
    assert response.status == 200, 'Response body is : ' + (await response.read()).decode('utf-8')

