/**
 * ThreatJammer.com User API
 *  The public API open to the users. [Read the docs and learn more.](https://threatjammer.com/docs).  ## General information  ### Description Threat Jammer supports two end-user REST APIs: the User API and the Report API. The end-user uses the User API to interact with the different databases, heuristics, and machine learning processes. Devices use the Report API to interact with Threat Jammer. This document will explain how to use the User API and interact with the different services, create a token, interpret the quota information, and create the HTTP request to interact with the User API.  ### Authentication The API is protected by a **Bearer authentication** schema. **Bearer authentication** (also called **token authentication**) is an HTTP authentication scheme that involves security tokens called bearer tokens. It is used to authenticate the user. All the different endpoints expect a `Bearer` token in the `Authorization` header.  Example:  ``` curl -X 'GET'   'https://dublin.api.threatjammer.com/test'   -H 'accept: application/json'   -H 'Authorization: Bearer YOUR_API_KEY' ```  You can obtain a token after registering on the [ThreatJammer.com](https://threatjammer.com) website for free.   ### Region specific tokens All the `Bearer` tokens contain information about the authorized region. The developers have to use a token created for the region they want to use. A token used in a different region will return a `401 Unauthorized` error.  ### Global errors  The API will return the following permanent errors: - a `401 Unauthorized` error if the token is not valid, or does not belong to the region. - a `401 Unauthorized` error if the token does not exist. - a `401 Unauthorized` error if the token is malformed. - a `403 Forbidden` error if the subscription level is not enough. Some endpoints are only available for paid subscription levels.  And these temporary errors: - a `429 Too Many Requests` error if the quota is exceeded (see below).  ### Quota limits  **Every request to the User API will consume one (1) quota point.**  The API has two rate limiting processes: - a quota limit of **5000** requests per month for the `FREE` account. The limit is reset every month. - a quota limit of **10** requests per minute for the `FREE` account. The limit is reset every minute and implements a sliding window mechanism.  
 *
 * The version of the OpenAPI document: 1.2.27
 * Contact: support@threatjammer.com
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 *
 */


import ApiClient from "../ApiClient";
import HTTPValidationError from '../model/HTTPValidationError';
import IPLogCollectionOutput from '../model/IPLogCollectionOutput';
import IPLogOutput from '../model/IPLogOutput';

/**
* DataLogging service.
* @module api/DataLoggingApi
* @version 1.2.27
*/
export default class DataLoggingApi {

    /**
    * Constructs a new DataLoggingApi. 
    * @alias module:api/DataLoggingApi
    * @class
    * @param {module:ApiClient} [apiClient] Optional API client implementation to use,
    * default to {@link module:ApiClient#instance} if unspecified.
    */
    constructor(apiClient) {
        this.apiClient = apiClient || ApiClient.instance;
    }


    /**
     * Callback function to receive the result of the logChangeIdV1LogIpIdLogchangeIdGet operation.
     * @callback module:api/DataLoggingApi~logChangeIdV1LogIpIdLogchangeIdGetCallback
     * @param {String} error Error message, if any.
     * @param {module:model/IPLogOutput} data The data returned by the service call.
     * @param {String} response The complete HTTP response.
     */

    /**
     * Get a log event.
     * ### What Obtain the full detail of a specific log change.  ### Parameters The endpoint accepts only the following parameters in the path: - ``logchange_id``: (Mandatory) A unique integer of the change event log.  ### Result The result is a JSON object with the following structure: - ``self``: the URI of the API call - ``cidr``: The CIDR affected by the change. - ``score``: The score of the IP address when the event happened. It ranges from 0 to 99. - ``risk``: The risk of the IP address when the event happened. The allowed values are: LOW, MEDIUM, HIGH. It's a human readable representation of the score. - ``dataset``: The URI of the dataset where the change was logged. - ``source``: The URI of the data source where the change was found. - ``lapse``: The time elapsed between the event found and the moment the source was queried. The possible values are: 1H, 6H, 12H, 1D, 7D, 30D, 90D, 180D, 365D. - ``action``: The action that was performed on the IP address. The allowed values are: ADD, DELETE. - ``timestamp``: The UNIX timestamp in milliseconds when the change was logged.   ### Errors The endpoint will return the following errors: - a `404 Not Found` error if there is no event in the log with the ``logchange_ID`` given. - a `422 Unprocessable Entity` error if the ``logchange_ID`` is malformed.  It will also return the API Global errors described in the API description.
     * @param {Number} logchangeId 
     * @param {module:api/DataLoggingApi~logChangeIdV1LogIpIdLogchangeIdGetCallback} callback The callback function, accepting three arguments: error, data, response
     * data is of type: {@link module:model/IPLogOutput}
     */
    logChangeIdV1LogIpIdLogchangeIdGet(logchangeId, callback) {
      let postBody = null;
      // verify the required parameter 'logchangeId' is set
      if (logchangeId === undefined || logchangeId === null) {
        throw new Error("Missing the required parameter 'logchangeId' when calling logChangeIdV1LogIpIdLogchangeIdGet");
      }

      let pathParams = {
        'logchange_id': logchangeId
      };
      let queryParams = {
      };
      let headerParams = {
      };
      let formParams = {
      };

      let authNames = ['HTTPBearer'];
      let contentTypes = [];
      let accepts = ['application/json'];
      let returnType = IPLogOutput;
      return this.apiClient.callApi(
        '/v1/log/ip/id/{logchange_id}', 'GET',
        pathParams, queryParams, headerParams, formParams, postBody,
        authNames, contentTypes, accepts, returnType, null, callback
      );
    }

    /**
     * Callback function to receive the result of the logchangesIpV1LogIpIpAddressGet operation.
     * @callback module:api/DataLoggingApi~logchangesIpV1LogIpIpAddressGetCallback
     * @param {String} error Error message, if any.
     * @param {module:model/IPLogCollectionOutput} data The data returned by the service call.
     * @param {String} response The complete HTTP response.
     */

    /**
     * Get the changes logged in the different datasets of an IP address.
     * ### What Obtain a list of changes logged in the different datasets of the IP address given.  ### Parameters The endpoint accepts the following parameters in the path: - ``ip_address``: (Mandatory) The public IPv4 or IPv6 addresses to be queried.  The endpoint accepts the following parameters in the query string: - ``dataset``: (Optional) Name of the dataset to filter the query. If not given, then all datasets are queried. If given, then only the changes logged in the given dataset are returned. The list of datasets is obtained from the ``/v1/dataset/ip`` endpoint. - ``logged_after``: (Optional) The UNIX timestamp in milliseconds of the earliest date to be included in the query. If not given, then the earliest date is the date of the first change logged in the dataset.   ### Result The result is a JSON object with the following structure: - ``self``: the URI of the API call - ``logs``: The list of log changes. Each element of the list is a JSON object of a specific log change with the structure described in the endpoint ``/v1/log/ip/id/logchange_id``. ### Errors The endpoint will return the following errors: - a `400 Bad Request` error if the IP address is not public. - a `400 Bad Request` error if the timestamp is in the future. - a `400 Bad Request` error if the dataset is not a string that can have numbers, upper and lower case letters, and underscores. - a `404 Not Found` error if the dataset was not found. - a `422 Unprocessable Entity` error if the IP address is malformed.  It will also return the API Global errors described in the API description.
     * @param {String} ipAddress The IPv4 or IPv6 address to asses the risk
     * @param {Object} opts Optional parameters
     * @param {String} [dataset] The name of the dataset to restrict the query
     * @param {Number} [loggedAfter] A UNIX timestamp in milliseconds to restrict the results of the query to entries logged after this value.
     * @param {module:api/DataLoggingApi~logchangesIpV1LogIpIpAddressGetCallback} callback The callback function, accepting three arguments: error, data, response
     * data is of type: {@link module:model/IPLogCollectionOutput}
     */
    logchangesIpV1LogIpIpAddressGet(ipAddress, opts, callback) {
      opts = opts || {};
      let postBody = null;
      // verify the required parameter 'ipAddress' is set
      if (ipAddress === undefined || ipAddress === null) {
        throw new Error("Missing the required parameter 'ipAddress' when calling logchangesIpV1LogIpIpAddressGet");
      }

      let pathParams = {
        'ip_address': ipAddress
      };
      let queryParams = {
        'dataset': opts['dataset'],
        'logged_after': opts['loggedAfter']
      };
      let headerParams = {
      };
      let formParams = {
      };

      let authNames = ['HTTPBearer'];
      let contentTypes = [];
      let accepts = ['application/json'];
      let returnType = IPLogCollectionOutput;
      return this.apiClient.callApi(
        '/v1/log/ip/{ip_address}', 'GET',
        pathParams, queryParams, headerParams, formParams, postBody,
        authNames, contentTypes, accepts, returnType, null, callback
      );
    }


}
